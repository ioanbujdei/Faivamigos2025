<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suggestion Page</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* Basic styling for the page */
        .container {
            display: flex;
            gap: 20px;
        }
        .main-content {
            flex: 3;
        }
        .sidebar {
            flex: 1;
        }
        .vote-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .vote-button {
            cursor: pointer;
            border: none;
            background: none;
            font-size: 20px;
        }
        .upvote:hover {
            color: green;
        }
        .downvote:hover {
            color: red;
        }
        .full-description {
            display: none; /* Initially hide the full description */
        }
        .comment-section textarea {
            width: 100%;
            height: 80px;
            margin-bottom: 10px;
        }
        .comment {
            margin-bottom: 10px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        .delete-btn {
            background-color: #ff4d4d;
            color: white;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
            border-radius: 3px;
        }
    </style>
</head>
<body>

    <div class="container">
        <!-- Main Content -->
        <div class="main-content">
            <a href="home.html">Home</a>
            <h1>Suggestion #1</h1>
            <img src="https://picsum.photos/300/200" alt="Random Placeholder Image">
            
            <div class="description" id="shortDescription">
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur vehicula magna at tristique interdum.</p>
            </div>
        
            <div class="full-description" id="fullDescription">
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla ac ligula in felis pharetra congue. Suspendisse potenti. Duis quis turpis eget lorem fringilla interdum. Donec sed justo non purus cursus gravida et et metus. Aenean ac risus eu nisl suscipit gravida ac vitae lorem.</p>
            </div>
            <button class="show-more-btn" id="showMoreBtn" onclick="toggleDescription()">Show More</button>
        
            <div class="vote-container">
                <button id="upvoteBtn" class="vote-button upvote" onclick="handleVote('up')">⬆</button>
                <div id="voteCount">0</div>
                <button id="downvoteBtn" class="vote-button downvote" onclick="handleVote('down')">⬇</button>
            </div>
        
            <div class="comment-section">
                <h3>Comments</h3>
                <textarea id="commentInput" placeholder="Write a comment..."></textarea>
                <button onclick="addComment()">Post Comment</button>
                <div id="commentList"></div>
            </div>
        </div>

        <!-- Popular Projects Sidebar -->
        <div class="sidebar">
            <h2>Popular Projects</h2>

            <div class="popular-project">
                <h3>Project 1</h3>
                <div class="project-content">
                    <button class="vote-button" onclick="handleProjectVote(0, 'up')">⬆</button>
                    <span id="projectVote0">0</span>
                    <img src="https://picsum.photos/100/70" alt="Project 1">
                    <button class="vote-button" onclick="handleProjectVote(0, 'down')">⬇</button>
                </div>
            </div>

            <div class="popular-project">
                <h3>Project 2</h3>
                <div class="project-content">
                    <button class="vote-button" onclick="handleProjectVote(1, 'up')">⬆</button>
                    <span id="projectVote1">0</span>
                    <img src="https://picsum.photos/100/70?random=1" alt="Project 2">
                    <button class="vote-button" onclick="handleProjectVote(1, 'down')">⬇</button>
                </div>
            </div>

            <div class="popular-project">
                <h3>Project 3</h3>
                <div class="project-content">
                    <button class="vote-button" onclick="handleProjectVote(2, 'up')">⬆</button>
                    <span id="projectVote2">0</span>
                    <img src="https://picsum.photos/100/70?random=2" alt="Project 3">
                    <button class="vote-button" onclick="handleProjectVote(2, 'down')">⬇</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Suggestion Page Voting Logic
        let voteCount = localStorage.getItem("voteCount") ? parseInt(localStorage.getItem("voteCount")) : 0;
        let currentVote = localStorage.getItem("currentVote") || null; // 'up', 'down', or null

        function updateVoteCount() {
            document.getElementById("voteCount").innerText = voteCount;
            localStorage.setItem("voteCount", voteCount);
        }

        function handleVote(type) {
            if (currentVote === type) {
                // If the user clicks the same button again, remove their vote
                voteCount -= (type === 'up' ? 1 : -1);
                currentVote = null;
            } else {
                // If the user switches their vote
                if (currentVote === 'up') {
                    voteCount--; // Remove the previous upvote
                } else if (currentVote === 'down') {
                    voteCount++; // Remove the previous downvote
                }

                // Add the new vote
                if (type === 'up') {
                    voteCount++;
                } else if (type === 'down') {
                    voteCount--;
                }

                currentVote = type;
            }

            // Save the updated vote count and current vote
            localStorage.setItem("voteCount", voteCount);
            localStorage.setItem("currentVote", currentVote);
            updateVoteCount();
        }

        // Initialize vote count and current vote
        document.addEventListener("DOMContentLoaded", function () {
            updateVoteCount();
        });

        // Popular Projects Voting Logic
        function handleProjectVote(index, type) {
            let projectVotes = JSON.parse(localStorage.getItem("projectVotes")) || [{ voteCount: 0, currentVote: null }, { voteCount: 0, currentVote: null }, { voteCount: 0, currentVote: null }];
            let project = projectVotes[index];

            if (project.currentVote === type) {
                // If the user clicks the same button again, remove their vote
                project.voteCount -= (type === 'up' ? 1 : -1);
                project.currentVote = null;
            } else {
                // If the user switches their vote
                if (project.currentVote === 'up') {
                    project.voteCount--; // Remove the previous upvote
                } else if (project.currentVote === 'down') {
                    project.voteCount++; // Remove the previous downvote
                }

                // Add the new vote
                if (type === 'up') {
                    project.voteCount++;
                } else if (type === 'down') {
                    project.voteCount--;
                }

                project.currentVote = type;
            }

            // Save the updated project votes
            localStorage.setItem("projectVotes", JSON.stringify(projectVotes));

            // Update the displayed vote count
            document.getElementById(`projectVote${index}`).innerText = project.voteCount;
        }

        // Initialize vote counts for popular projects
        document.addEventListener("DOMContentLoaded", function () {
            let projectVotes = JSON.parse(localStorage.getItem("projectVotes")) || [{ voteCount: 0, currentVote: null }, { voteCount: 0, currentVote: null }, { voteCount: 0, currentVote: null }];
            for (let i = 0; i < 3; i++) {
                document.getElementById(`projectVote${i}`).innerText = projectVotes[i].voteCount;
            }
        });

        // Comment Section Logic
        function addComment() {
            let commentInput = document.getElementById("commentInput");
            let commentText = commentInput.value.trim();
            if (commentText === "") return;
            
            // Get the current comments from localStorage, or an empty array if none exist
            let comments = JSON.parse(localStorage.getItem("comments")) || [];
            comments.push(commentText); // Add the new comment to the list

            // Save updated comments to localStorage
            localStorage.setItem("comments", JSON.stringify(comments));

            // Clear the input field
            commentInput.value = "";

            // Display the updated comments
            displayComments();
        }

        function displayComments() {
            let commentList = document.getElementById("commentList");
            commentList.innerHTML = ""; // Clear the current comment list
            let comments = JSON.parse(localStorage.getItem("comments")) || [];

            // Create a div for each comment
            comments.forEach((comment, index) => {
                let commentDiv = document.createElement("div");
                commentDiv.classList.add("comment");
                commentDiv.innerHTML = `
                    <p>${comment}</p>
                    <button class="delete-btn" onclick="deleteComment(${index})">Delete</button>
                `;
                commentList.appendChild(commentDiv);
            });
        }

        function deleteComment(index) {
            let comments = JSON.parse(localStorage.getItem("comments")) || [];
            comments.splice(index, 1); // Remove the comment at the given index
            localStorage.setItem("comments", JSON.stringify(comments)); // Save updated comments
            displayComments(); // Re-render the comment list
        }

        // Load existing comments when the page is loaded
        document.addEventListener("DOMContentLoaded", displayComments);

        // Show More Button Logic
        function toggleDescription() {
            let fullDescription = document.getElementById("fullDescription");
            let shortDescription = document.getElementById("shortDescription");
            let showMoreBtn = document.getElementById("showMoreBtn");

            if (fullDescription.style.display === "none" || fullDescription.style.display === "") {
                fullDescription.style.display = "block";
                shortDescription.style.display = "none";
                showMoreBtn.innerText = "Show Less";
            } else {
                fullDescription.style.display = "none";
                shortDescription.style.display = "block";
                showMoreBtn.innerText = "Show More";
            }
        }
    </script>

</body>
</html>
